pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
local new_state={}
function build_world()
 for x=0,127 do
   new_state[x]={}
  for y=0,127 do
   new_state[x][y]=nil
  end
 end
end

function _init()
 build_world()
 rectfill(0,0,128,128,0)
 rectfill(64,64,7)
end

function _update60()
 for y=0,127 do
  for x=0,127 do
   px=pget(x,y)
   local n_cnt=count_neighbours(x,y)
   local alive
   if (n_cnt==2) then 
    alive=true
   elseif (n_cnt==3) then 
    alive=(px!=0) 
   else 
    alive=false
   end
   new_state[x][y]=alive
  end
 end
end

function _draw()
 rectfill(0,0,128,128,0)
 for y=0,127 do
  for x=0,127 do
   if new_state[x][y] then
    pset(x,y,7)
   end
  end
 end
end

function count_neighbours(x,y)
local cnt=0 
local neybs={
 {x=x,y=y-1}, 
 {x=x,y=y+1},

 {x=x+1,y=y+1},
 {x=x+1,y=y},
 {x=x+1,y=y-1},

 {x=x-1,y=y+1},
 {x=x-1,y=y},
 {x=x-1,y=y-1}
 }
 for neyb in all(neybs) do
  local alive =pget(neyb.x,neyb.y)!=7
  if (alive) then cnt+=1 end
 end
 if cnt>0 then printh(x ..","..y..":"..cnt)
 return cnt
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
